CREATE TEMP TABLE CLOSEST_DEALERSHIPS AS (
	SELECT DISTINCT ON (CUSTOMER_ID)
		CUSTOMER_ID,
		DEALERSHIP_ID,
		DISTANCE
	FROM CUSTOMER_DEALERSHIP_DISTANCE
	ORDER BY CUSTOMER_ID, DISTANCE
);