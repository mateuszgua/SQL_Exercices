WITH PR AS (
SELECT S.CUSTOMER_ID, S.SALES_AMOUNT, P.*
	FROM SALES S
	LEFT JOIN
	PRODUCTS P ON S.PRODUCT_ID = P.PRODUCT_ID
)
SELECT *,
	CASE WHEN ((PR.BASE_MSRP - PR.SALES_AMOUNT) > 500) THEN 1
	ELSE 0 END AS HIGH_SAVINGS
FROM CUSTOMERS C
FULL JOIN
PR ON C.CUSTOMER_ID = PR.CUSTOMER_ID
ORDER BY C.CUSTOMER_ID;
