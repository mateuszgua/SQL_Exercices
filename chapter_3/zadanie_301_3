WITH CS AS (
	SELECT C.STATE, S.*
	FROM CUSTOMERS C
	LEFT JOIN
	SALES S ON C.CUSTOMER_ID = S.CUSTOMER_ID
)
SELECT CS.STATE, SUM(CS.SALES_AMOUNT) AS TOTAL_SUM
FROM CS
GROUP BY CS.STATE
ORDER BY CS.STATE;